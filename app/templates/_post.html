<div class="bg-white rounded-xl shadow-md p-5 hover:shadow-lg transition-shadow duration-300">
    <div class="flex items-start space-x-4">
    
        <div class="flex-1">    
            <div class="flex items-center justify-between">
                <!-- Аватар + Имя автора -->
                <div class="flex items-center space-x-2">
                    <a href="{{ url_for('user', username=post.author.username) }}">
                        <img src="{{ post.author.avatar(40) }}" 
                            alt="Avatar" 
                            class="w-10 h-10 rounded-lg border-4 border-gray-100 shadow-sm transition-transform duration-300 hover:scale-110">
                    </a>
                    
                    <!-- Имя автора -->
                    <a href="{{ url_for('user', username=post.author.username) }}" 
                    class="font-semibold text-gray-800 hover:text-purple-600 transition-colors">
                        {{ post.author.username }}
                    </a>
                </div>

                <!-- Время (справа в углу) -->
                <span class="text-xs text-gray-400">
                    {{ moment(post.timestamp).fromNow() }}
                </span>
            </div>

            <!-- Заголовок статьи -->
            {% if post.title %}
                <h2 class="mt-2 text-xl font-bold text-gray-900">
                    <a href="{{ url_for('post_detail', post_id=post.id) }}" class="hover:text-blue-600">
                        {{ post.title }}
                    </a>
                </h2>
            {% endif %}

            <!-- Изображение к посту -->
            {% if post.images|length > 0 %}
                <div class="mt-3 flex justify-center">
                    <img src="{{ post.images[0].url }}" 
                        alt="{{ post.images[0].caption or 'Post image' }}" 
                        class="max-w-full h-auto rounded-lg shadow-sm">
                </div>
            {% endif %}
            
            <!-- Текст поста -->
            <div class="mt-3 text-gray-700 whitespace-pre-line">
                {{ post.body }}
            </div>

            <!-- Кнопки действий -->
            {% if post.author == current_user %}
                <div class="mt-4 flex justify-between items-center">
                    <!-- Редактирование -->
                    <a href="{{ url_for('edit_post', id=post.id) }}" 
                    class="relative inline-flex items-center px-4 py-2 rounded-full text-white font-medium overflow-hidden group focus:outline-none">
                        <span class="absolute inset-0 bg-gradient-to-r from-blue-500 to-indigo-600"></span>
                        <span class="relative z-10 flex items-center">
                            <i class="fas fa-edit mr-2"></i> {{ _('Edit') }}
                        </span>
                        <span class="absolute inset-0 bg-white opacity-0 group-hover:opacity-20 transition-opacity"></span>
                    </a>

                    <!-- Удаление -->
                    <form action="{{ url_for('delete_post', post_id=post.id) }}" method="POST" class="mb-0">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
                        <button type="submit" 
                                onclick="return confirmDelete(event)"
                                class="relative inline-flex items-center px-4 py-2 rounded-full text-white font-medium overflow-hidden group focus:outline-none">
                            <span class="absolute inset-0 bg-gradient-to-r from-red-500 to-orange-500"></span>
                            <span class="relative z-10 flex items-center">
                                <i class="fas fa-trash-alt mr-2"></i> {{ _('Delete') }}
                            </span>
                            <span class="absolute inset-0 bg-white opacity-0 group-hover:opacity-20 transition-opacity"></span>
                        </button>
                    </form>
                </div>
            {% endif %}
        </div>
    </div>
</div>

<script>
    function confirmDelete(event) {
        const isConfirmed = confirm("Are you sure you want to delete this post?");
        if (!isConfirmed) {
            event.preventDefault(); 
            return false;
        }
        return true;
    }
</script>